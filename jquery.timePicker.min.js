(function(n){function f(t,i,r){t.value=n(i).text(),n(t).change(),r.hide()}function t(n,t){var i=n.getHours(),r=t.show24Hours?i:(i+11)%12+1,u=n.getMinutes();return e(r)+t.separator+e(u)+(t.show24Hours?"":i<12?" AM":" PM")}function e(n){return(n<10?"0":"")+n}function i(n,t){return typeof n=="object"?u(n):r(n,t)}function r(n,t){var f;if(n){var r=n.split(t.separator),i=parseFloat(r[0]),e=parseFloat(r[1]);return t.show24Hours||(i===12&&n.indexOf("AM")!==-1?i=0:i!==12&&n.indexOf("PM")!==-1&&(i+=12)),f=new Date(0,0,0,i,e,0),u(f)}return null}function u(n){return n.setFullYear(2001),n.setMonth(0),n.setDate(0),n}n.fn.timePicker=function(t){var i=n.extend({},n.fn.timePicker.defaults,t);return this.each(function(){n.timePicker(this,i)})},n.timePicker=function(t,i){var r=n(t)[0];return r.timePicker||(r.timePicker=new jQuery._timePicker(r,i))},n.timePicker.version="0.3",n._timePicker=function(e,o){var v=!1,k=!1,l=i(o.startTime,o),d=i(o.endTime,o),h="selected",w="li."+h,y,a,s,c,b,p,g;for(n(e).attr("autocomplete","OFF"),y=[],a=new Date(l);a<=d;)y[y.length]=t(a,o),a=new Date(a.setMinutes(a.getMinutes()+o.step));for(s=n('<div class="time-picker'+(o.show24Hours?"":" time-picker-12hours")+'"><\/div>'),c=n("<ul><\/ul>"),b=0;b<y.length;b++)c.append("<li>"+y[b]+"<\/li>");s.append(c),s.appendTo("body").hide(),s.mouseover(function(){v=!0}).mouseout(function(){v=!1}),n("li",c).mouseover(function(){k||(n(w,s).removeClass(h),n(this).addClass(h))}).mousedown(function(){v=!0}).click(function(){f(e,this,s,o),v=!1}),p=function(){var c,f;if(s.is(":visible"))return!1;n("li",s).removeClass(h),c=n(e).offset(),s.css({top:c.top+e.offsetHeight,left:c.left}),s.show();var a=e.value?r(e.value,o):l,v=l.getHours()*60+l.getMinutes(),y=a.getHours()*60+a.getMinutes()-v,p=Math.round(y/o.step),i=u(new Date(0,0,0,0,p*o.step+v,0));return i=l<i&&i<=d?i:l,f=n("li:contains("+t(i,o)+")",s),f.length&&(f.addClass(h),s[0].scrollTop=f[0].offsetTop),!0},n(e).focus(p).click(p),n(e).blur(function(){v||s.hide()}),g=navigator.userAgent.indexOf("opera")>=0||navigator.userAgent.indexOf("mozilla")>=0?"keypress":"keydown",n(e)[g](function(t){var i,l,r,u,a;k=!0,l=s[0].scrollTop;switch(t.keyCode){case 38:return p()?!1:(i=n(w,c),r=i.prev().addClass(h)[0],r?(i.removeClass(h),r.offsetTop<l&&(s[0].scrollTop=l-r.offsetHeight)):(i.removeClass(h),r=n("li:last",c).addClass(h)[0],s[0].scrollTop=r.offsetTop-r.offsetHeight),!1);case 40:return p()?!1:(i=n(w,c),u=i.next().addClass(h)[0],u?(i.removeClass(h),u.offsetTop+u.offsetHeight>l+s[0].offsetHeight&&(s[0].scrollTop=l+u.offsetHeight)):(i.removeClass(h),u=n("li:first",c).addClass(h)[0],s[0].scrollTop=0),!1);case 13:return s.is(":visible")&&(a=n(w,c)[0],f(e,a,s,o)),!1;case 27:return s.hide(),!1}return!0}),n(e).keyup(function(){k=!1}),this.getTime=function(){return r(e.value,o)},this.setTime=function(r){e.value=t(i(r,o),o),n(e).change()}},n.fn.timePicker.defaults={step:30,startTime:new Date(0,0,0,0,0,0),endTime:new Date(0,0,0,23,30,0),separator:":",show24Hours:!0}})(jQuery)